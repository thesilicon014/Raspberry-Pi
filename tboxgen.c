 #include<stdio.h>
 
 unsigned int matrixmult(unsigned int, unsigned int);
 
 int main() {
	int i;
	unsigned int tdev[256][4];
	unsigned long t[256];
	unsigned int s[256] = {
    0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76,
    0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0,
    0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15,
    0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75,
    0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84,
    0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF,
    0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8,
    0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2,
    0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73,
    0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB,
    0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79,
    0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08,
    0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A,
    0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E,
    0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF,
    0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16};
	
	unsigned long t0[256] = {
		0xC66363A5,0xF87C7C84,0xEE777799,0xF67B7B8D,0xFFF2F20D,0xD66B6BBD,0xDE6F6FB1,0x91C5C554,
		0x60303050,0x02010103,0xCE6767A9,0x562B2B7D,0xE7FEFE19,0xB5D7D762,0x4DABABE6,0xEC76769A,
		0x8FCACA45,0x1F82829D,0x89C9C940,0xFA7D7D87,0xEFFAFA15,0xB25959EB,0x8E4747C9,0xFBF0F00B,
		0x41ADADEC,0xB3D4D467,0x5FA2A2FD,0x45AFAFEA,0x239C9CBF,0x53A4A4F7,0xE4727296,0x9BC0C05B,
		0x75B7B7C2,0xE1FDFD1C,0x3D9393AE,0x4C26266A,0x6C36365A,0x7E3F3F41,0xF5F7F702,0x83CCCC4F,
		0x6834345C,0x51A5A5F4,0xD1E5E534,0xF9F1F108,0xE2717193,0xABD8D873,0x62313153,0x2A15153F,
		0x0804040C,0x95C7C752,0x46232365,0x9DC3C35E,0x30181828,0x379696A1,0x0A05050F,0x2F9A9AB5,
		0x0E070709,0x24121236,0x1B80809B,0xDFE2E23D,0xCDEBEB26,0x4E272769,0x7FB2B2CD,0xEA75759F,
		0x1209091B,0x1D83839E,0x582C2C74,0x341A1A2E,0x361B1B2D,0xDC6E6EB2,0xB45A5AEE,0x5BA0A0FB,
		0xA45252F6,0x763B3B4D,0xB7D6D661,0x7DB3B3CE,0x5229297B,0xDDE3E33E,0x5E2F2F71,0x13848497,
		0xA65353F5,0xB9D1D168,0x00000000,0xC1EDED2C,0x40202060,0xE3FCFC1F,0x79B1B1C8,0xB65B5BED,
		0xD46A6ABE,0x8DCBCB46,0x67BEBED9,0x7239394B,0x944A4ADE,0x984C4CD4,0xB05858E8,0x85CFCF4A,
		0xBBD0D06B,0xC5EFEF2A,0x4FAAAAE5,0xEDFBFB16,0x864343C5,0x9A4D4DD7,0x66333355,0x11858594,
		0x8A4545CF,0xE9F9F910,0x04020206,0xFE7F7F81,0xA05050F0,0x783C3C44,0x259F9FBA,0x4BA8A8E3,
		0xA25151F3,0x5DA3A3FE,0x804040C0,0x058F8F8A,0x3F9292AD,0x219D9DBC,0x70383848,0xF1F5F504,
		0x63BCBCDF,0x77B6B6C1,0xAFDADA75,0x42212163,0x20101030,0xE5FFFF1A,0xFDF3F30E,0xBFD2D26D,
		0x81CDCD4C,0x180C0C14,0x26131335,0xC3ECEC2F,0xBE5F5FE1,0x359797A2,0x884444CC,0x2E171739,
		0x93C4C457,0x55A7A7F2,0xFC7E7E82,0x7A3D3D47,0xC86464AC,0xBA5D5DE7,0x3219192B,0xE6737395,
		0xC06060A0,0x19818198,0x9E4F4FD1,0xA3DCDC7F,0x44222266,0x542A2A7E,0x3B9090AB,0x0B888883,
		0x8C4646CA,0xC7EEEE29,0x6BB8B8D3,0x2814143C,0xA7DEDE79,0xBC5E5EE2,0x160B0B1D,0xADDBDB76,
		0xDBE0E03B,0x64323256,0x743A3A4E,0x140A0A1E,0x924949DB,0x0C06060A,0x4824246C,0xB85C5CE4,
		0x9FC2C25D,0xBDD3D36E,0x43ACACEF,0xC46262A6,0x399191A8,0x319595A4,0xD3E4E437,0xF279798B,
		0xD5E7E732,0x8BC8C843,0x6E373759,0xDA6D6DB7,0x018D8D8C,0xB1D5D564,0x9C4E4ED2,0x49A9A9E0,
		0xD86C6CB4,0xAC5656FA,0xF3F4F407,0xCFEAEA25,0xCA6565AF,0xF47A7A8E,0x47AEAEE9,0x10080818,
		0x6FBABAD5,0xF0787888,0x4A25256F,0x5C2E2E72,0x381C1C24,0x57A6A6F1,0x73B4B4C7,0x97C6C651,
		0xCBE8E823,0xA1DDDD7C,0xE874749C,0x3E1F1F21,0x964B4BDD,0x61BDBDDC,0x0D8B8B86,0x0F8A8A85,
		0xE0707090,0x7C3E3E42,0x71B5B5C4,0xCC6666AA,0x904848D8,0x06030305,0xF7F6F601,0x1C0E0E12,
		0xC26161A3,0x6A35355F,0xAE5757F9,0x69B9B9D0,0x17868691,0x99C1C158,0x3A1D1D27,0x279E9EB9,
		0xD9E1E138,0xEBF8F813,0x2B9898B3,0x22111133,0xD26969BB,0xA9D9D970,0x078E8E89,0x339494A7,
		0x2D9B9BB6,0x3C1E1E22,0x15878792,0xC9E9E920,0x87CECE49,0xAA5555FF,0x50282878,0xA5DFDF7A,
		0x038C8C8F,0x59A1A1F8,0x09898980,0x1A0D0D17,0x65BFBFDA,0xD7E6E631,0x844242C6,0xD06868B8,
		0x824141C3,0x299999B0,0x5A2D2D77,0x1E0F0F11,0x7BB0B0CB,0xA85454FC,0x6DBBBBD6,0x2C16163A };
		
	unsigned long t1[256] = {
		0xA5C66363,0x84F87C7C,0x99EE7777,0x8DF67B7B,0x0DFFF2F2,0xBDD66B6B,0xB1DE6F6F,0x5491C5C5,
		0x50603030,0x03020101,0xA9CE6767,0x7D562B2B,0x19E7FEFE,0x62B5D7D7,0xE64DABAB,0x9AEC7676,
		0x458FCACA,0x9D1F8282,0x4089C9C9,0x87FA7D7D,0x15EFFAFA,0xEBB25959,0xC98E4747,0x0BFBF0F0,
		0xEC41ADAD,0x67B3D4D4,0xFD5FA2A2,0xEA45AFAF,0xBF239C9C,0xF753A4A4,0x96E47272,0x5B9BC0C0,
		0xC275B7B7,0x1CE1FDFD,0xAE3D9393,0x6A4C2626,0x5A6C3636,0x417E3F3F,0x02F5F7F7,0x4F83CCCC,
		0x5C683434,0xF451A5A5,0x34D1E5E5,0x08F9F1F1,0x93E27171,0x73ABD8D8,0x53623131,0x3F2A1515,
		0x0C080404,0x5295C7C7,0x65462323,0x5E9DC3C3,0x28301818,0xA1379696,0x0F0A0505,0xB52F9A9A,
		0x090E0707,0x36241212,0x9B1B8080,0x3DDFE2E2,0x26CDEBEB,0x694E2727,0xCD7FB2B2,0x9FEA7575,
		0x1B120909,0x9E1D8383,0x74582C2C,0x2E341A1A,0x2D361B1B,0xB2DC6E6E,0xEEB45A5A,0xFB5BA0A0,
		0xF6A45252,0x4D763B3B,0x61B7D6D6,0xCE7DB3B3,0x7B522929,0x3EDDE3E3,0x715E2F2F,0x97138484,
		0xF5A65353,0x68B9D1D1,0x00000000,0x2CC1EDED,0x60402020,0x1FE3FCFC,0xC879B1B1,0xEDB65B5B,
		0xBED46A6A,0x468DCBCB,0xD967BEBE,0x4B723939,0xDE944A4A,0xD4984C4C,0xE8B05858,0x4A85CFCF,
		0x6BBBD0D0,0x2AC5EFEF,0xE54FAAAA,0x16EDFBFB,0xC5864343,0xD79A4D4D,0x55663333,0x94118585,
		0xCF8A4545,0x10E9F9F9,0x06040202,0x81FE7F7F,0xF0A05050,0x44783C3C,0xBA259F9F,0xE34BA8A8,
		0xF3A25151,0xFE5DA3A3,0xC0804040,0x8A058F8F,0xAD3F9292,0xBC219D9D,0x48703838,0x04F1F5F5,
		0xDF63BCBC,0xC177B6B6,0x75AFDADA,0x63422121,0x30201010,0x1AE5FFFF,0x0EFDF3F3,0x6DBFD2D2,
		0x4C81CDCD,0x14180C0C,0x35261313,0x2FC3ECEC,0xE1BE5F5F,0xA2359797,0xCC884444,0x392E1717,
		0x5793C4C4,0xF255A7A7,0x82FC7E7E,0x477A3D3D,0xACC86464,0xE7BA5D5D,0x2B321919,0x95E67373,
		0xA0C06060,0x98198181,0xD19E4F4F,0x7FA3DCDC,0x66442222,0x7E542A2A,0xAB3B9090,0x830B8888,
		0xCA8C4646,0x29C7EEEE,0xD36BB8B8,0x3C281414,0x79A7DEDE,0xE2BC5E5E,0x1D160B0B,0x76ADDBDB,
		0x3BDBE0E0,0x56643232,0x4E743A3A,0x1E140A0A,0xDB924949,0x0A0C0606,0x6C482424,0xE4B85C5C,
		0x5D9FC2C2,0x6EBDD3D3,0xEF43ACAC,0xA6C46262,0xA8399191,0xA4319595,0x37D3E4E4,0x8BF27979,
		0x32D5E7E7,0x438BC8C8,0x596E3737,0xB7DA6D6D,0x8C018D8D,0x64B1D5D5,0xD29C4E4E,0xE049A9A9,
		0xB4D86C6C,0xFAAC5656,0x07F3F4F4,0x25CFEAEA,0xAFCA6565,0x8EF47A7A,0xE947AEAE,0x18100808,
		0xD56FBABA,0x88F07878,0x6F4A2525,0x725C2E2E,0x24381C1C,0xF157A6A6,0xC773B4B4,0x5197C6C6,
		0x23CBE8E8,0x7CA1DDDD,0x9CE87474,0x213E1F1F,0xDD964B4B,0xDC61BDBD,0x860D8B8B,0x850F8A8A,
		0x90E07070,0x427C3E3E,0xC471B5B5,0xAACC6666,0xD8904848,0x05060303,0x01F7F6F6,0x121C0E0E,
		0xA3C26161,0x5F6A3535,0xF9AE5757,0xD069B9B9,0x91178686,0x5899C1C1,0x273A1D1D,0xB9279E9E,
		0x38D9E1E1,0x13EBF8F8,0xB32B9898,0x33221111,0xBBD26969,0x70A9D9D9,0x89078E8E,0xA7339494,
		0xB62D9B9B,0x223C1E1E,0x92158787,0x20C9E9E9,0x4987CECE,0xFFAA5555,0x78502828,0x7AA5DFDF,
		0x8F038C8C,0xF859A1A1,0x80098989,0x171A0D0D,0xDA65BFBF,0x31D7E6E6,0xC6844242,0xB8D06868,
		0xC3824141,0xB0299999,0x775A2D2D,0x111E0F0F,0xCB7BB0B0,0xFCA85454,0xD66DBBBB,0x3A2C1616 };
	
	//unsigned long t2[256] = { };
	
	FILE *fp;
	
	fp=fopen("t-2.csv","w+");
	
	printf("\n\n");
	 
	for(i=0;i<256;i++) {
		tdev[i][0] = matrixmult(s[i], 1);
		tdev[i][1] = matrixmult(s[i], 3);
		tdev[i][2] = matrixmult(s[i], 2);
		tdev[i][3] = matrixmult(s[i], 1);
		t[i] = 0;
		t[i] = tdev[i][0] << 24 ^ tdev[i][1] << 16 ^ tdev[i][2] << 8 ^ tdev[i][3];
		fprintf(fp,"0x%08X,", t[i]);
		printf("\n%03d | %08X", i, t[i]);
	}
	printf("\n\n");
	
	fclose(fp);
	
	return(0);
 }

  
unsigned int matrixmult(unsigned int a, unsigned int b) {
	unsigned int result;
	
	result = 0;
	
	if(b == 3){
		if(a<128){
			result = (a << 1);
		} else {
			result = ((a-128) << 1)^(0x1B);
		}
		result = result ^ a;
	} else if(b==2) {
		if(a<128){
			result = (a << 1);
		} else {
			result = ((a-128) << 1)^(0x1B);
		}
	} else if(b==1) {
		result = a;
	} else {
		result = 0;
	}
	
	return(result);
}
